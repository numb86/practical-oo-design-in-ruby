# 第1章 オブジェクト指向設計

オブジェクト指向の世界では、全てをオブジェクトとして捉える。  
オブジェクトはそれぞれが自身の振る舞いを持ち、オブジェクト同士は互い作用し合う。  
世界を、オブジェクト間で受け渡されるメッセージの連続で捉える。  
オブジェクト指向設計で重要なのは、コーディングテクニックよりも、上記のような視点を持つこと。

この章では、オブジェクト指向設計や設計についての概要を述べる他、本書全体で用いるオブジェクト指向の用語の定義を行う。

## 1.1 設計の賞賛

オブジェクト指向設計は、楽しさと生産性を両立させるプログラミング手法である。

「一度書き上げたら決して変更しないアプリケーション」であるならば、そのアプリケーションに設計は不要。  
とにかく仕様を満たす形で書き上げてしまえば、あとはそれを稼働させ続ければよい。  
だが現実的には、変化は訪れる。仕様の変更や追加が発生する。変更は避けられない。だからこそ設計が重要になる。

設計とは、コードの構成のこと。  
そして設計の目的は、未来のために選択肢を残すこと。  
現時点と未来の両方に対して費用対効果の高いコードの構成を考える。  
分かっているのは、変更は必ず発生するということだけであり、どんな変更が発生するか予測することは出来ない。そのため、変更コストを下げることで、どんな未来にも対応できるようにする。

変更が容易なアプリケーションは書くのが楽しいが、変更を拒むアプリケーションは書くことが苦痛になる。  
何をするのにもコストがかかり、変更の度に、次の変更にかかるコストがかかっていく。

なぜ、変更が難しくなってしまうのだろうか。

オブジェクトはアプリケーションの部品であり、オブジェクト間でメッセージを受け渡して相互作用が発生することで、アプリケーション全体の振る舞いが生まれる。  
メッセージの受け渡しが正しく行われるためには、メッセージの送り手が、受け手のことを正しく知っている必要がある。  
この知識が、オブジェクト間に依存関係を生む。そして依存関係が、変更を邪魔する。

依存関係が管理されていないと、オブジェクトが互いのことを知りすぎてしまう。  
そうすると、オブジェクトを1つ変更した際に、そのオブジェクトとメッセージのやり取りをしている別のオブジェクトも変更しなければならなくなる。すると今度は、その別のオブジェクトとやり取りをしているまた別のオブジェクトも変更する羽目になる。  
このようにして、些細な変更でも波及的に影響範囲が拡がっていき、やがて手に負えなくなる。

**オブジェクト指向設計は、変更を許容できるようなかたちでオブジェクトの依存関係を構成していくための、コーディングテクニックの集まり。**

## 1.2 設計の道具

オブジェクト指向の設計者は、設計のための道具として、原則（`SOLID`や`DRY`など）とデザインパターンを持つ。  
しかしいくら道具が普及しても、その使い方が間違っていれば問題は解決しない。  
本書では、道具を適切に扱えるようになるための知識を与える。

## 1.3 設計の行為

設計は漸進的なプロセスであり、実装やフィードバックと切り離して存在するものではない。  
そのため、アジャイル開発と相性がよい。

アジャイル開発は、未来を予測することは決して出来ないということを認め、受け入れた。  
言い換えれば、アジャイル開発は、変更が起きることを約束する。そして変更に対応できるかは、設計に掛かっている。

**オブジェクト指向設計における設計とは、未来を予測して事細かに実装内容を決定することではなく、変更が簡単になるようにどんなコード構成にするか考えることである。**

## 1.4 オブジェクト指向プログラミングのかんたんな導入

オブジェクト指向のアプリケーションは、オブジェクトとメッセージから構成される。

Ruby のようなクラスベースのオブジェクト指向言語では、クラスを定義できる。  
同じクラスから作られたインスタンスは、どれも同じメソッドを持つが、データはインスタンス毎に固有。メソッドはメッセージに応答して実行される。

クラスはオブジェクトの設計図だが、各クラスも、`Class`クラスから作られたインスタンスである。  
そのため、クラスは自由に作ることが可能であり、オブジェクト指向言語はプログラマが拡張していける。  
拡張していくうちにやがて、対象となるアプリケーションの領域や用途に特化した独自言語のようになっていく。  
その言語が楽しさをもたらすのか、苦痛をもたらすのかは、設計次第であり、それこそが本書の主題と言える。

## 1.5 まとめ

設計を成功させるには、設計理論を理解し、その理論を適切に扱えなければならない。  
よい設計を出来るかどうかは、設計者の、理論を実践に変換していく能力にかかっている。
