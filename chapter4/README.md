# 第4章 柔軟なインターフェースをつくる

オブジェクト指向アプリケーションは、メッセージによって定義される。  
設計においては、オブジェクト間で受け渡されるメッセージについても考慮しなければならない。  
オブジェクト間の会話は「インターフェース」を介して行われる。  
この章では、柔軟なインターフェースの作成を目指す。

## 4.1 インターフェースを理解する

オブジェクトがお互いを知りすぎていると、再利用が困難になってしまう。  
アプリケーション全体が1つのオブジェクトのようになっており、何かを変更すればその変更は他のオブジェクトにも波及してしまう。

だから、クラスが持っているメソッドのうち、どれを外部に晒すかが重要になる。

## 4.2 インターフェースを定義する

クラスのインターフェースは、パブリックインターフェースとプライベートインターフェースの2つに分かれる。

パブリックインターフェースは、パブリックなメソッドで構成される。  
パブリックメソッドは、外部から利用されることを想定しており、変更が起きにくいことが期待されている。

プライベートインターフェースは、プライベートなメソッドで構成される。  
プライベートメソッドは、外部から利用されることを想定していない。また、安定せず変更が起きやすい。

## 4.3 パブリックインターフェースを見つける

インターフェースの良し悪しの判断にも、今までと同じ物差しを使う。  
つまり、現時点での要求に応えつつ、将来の変更にも応えられるようなコードになるかどうか。  
よいパブリックインターフェースは変更に伴うコストを下げるが、悪いパブリックインターフェースはそれを上げてしまう。

コードを書き始める前にまず、ユースケース（要件）を満たすためにどんなオブジェクトとメッセージが必要かを洗い出すべき。  
それを試行錯誤し、それについて他の開発者と意思疎通するための便利なツールが、シーケンス図。

参考: [シーケンス図 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E5%9B%B3)

シーケンス図を描くことでオブジェクト間でやり取りしているメッセージが明記され、それが、メッセージの内容やメッセージを送る相手が妥当かを考えるキッカケになる。

そして、シーケンス図を描くことで、フォーカスがクラスからメッセージに移る。  
設計において重要なのは、クラスよりもメッセージ。メッセージに基づく視点は、クラスに基づく視点よりも、柔軟なアプリケーションを生み出す。

なぜなら、まず送るべきメッセージがあり、それの受け手としてオブジェクトがあるから。  
**オブジェクトが存在するからメッセージを送るのではなく、メッセージを送るためにオブジェクトが存在するのである。**

では、どんなメッセージを送るべきなのか。  
それを見極めるためには、「どのように」と「何を」の違いを認識していることが大切。

メッセージは、何をして欲しいかを受け手に伝えるべきであって、どのように振る舞ってほしいかを伝えてはいけない。  
後者は、実装の詳細に立ち入り過ぎており、相手のことを知り過ぎてしまっている。そのようなメッセージに応答するためには多くのパブリックメソッドを作ることになり、パブリックインターフェースは大きく不安定なものになってしまう。  
メッセージを送る側のオブジェクトも、文脈に依存してしまい、再利用が低くなってしまう。

「何を」を軸にしてメッセージについて考えることで、それぞれのオブジェクトが持つべき責務や知るべき内容についても見えてくる。  
どのようなメッセージを送るべきかが分かると、どのようなオブジェクトが必要なのかにも気付ける。
