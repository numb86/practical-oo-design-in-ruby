# 第2章 単一責任のクラスを設計する

クラスをどのようなものにすればよいだろうか？  
今現在求められている動作を行いつつ、あとからの変更も簡単にできるようになっているべき。  
そのための設計論を1から考える必要はなく、既にたくさんの研究がある。

## 2.1 クラスに属するものを決める

どのようなクラスを作るかで、アプリケーションの全体像は大きく変わる。  
だから、メソッドを正しくグルーピングしてクラスにまとめることは、とても重要。  
しかし、プロジェクトの初期段階では、正しくグルーピングすることは出来ない。完成が近づくにつれ、そして完成後も機能の変更や追加が発生する度に、変更を余儀なくされる。

変更を安全かつ楽に行えるかは、設計によって決まる。  
**設計とは、アプリケーションの可変性を保つために技巧を凝らすことであり、完璧を目指すための行為ではない。**

変更を簡単に行えるのがよい設計だが、それを考える前にまず、「変更が簡単である」とはどういうことなのか定義しておきたい。

- 変更は副作用をもたらさない
- 要件の変更が小さければ、コードの変更も相応して小さい
- 既存のコードは簡単に再利用できる
- 最も簡単な変更方法はコードの追加である。ただし追加するコードはそれ自体変更が容易なものとする

以上が、「変更が簡単であること」の定義。  
この定義を満たすためには、コードは以下のような性質を持っているべき。

- **見通しがよい(`Transparent`)**： 変更するコードにおいても、そのコードに依存する別の場所のコードにおいても、変更がもたらす影響が明白である
- **合理的（`Reasonable`）**： どんな変更であっても、かかるコストは変更がもたらす利益にふさわしい
- **利用性が高い（`Usable`）**： 新しい環境、予期していなかった環境でも再利用できる
- **模範的（`Exemplary`）**： コードに変更を加える人が、上記の品質を自然と保つようなコードになっている

頭文字をとって`TRUE`と呼ぶが、`TRUE`なコードは、現在のニーズを満たしつつ、将来のニーズを満たすための変更を加えることも出来る。

そして、それぞれのクラスが単一の責任を持つようにすることが、`TRUE`なコードを書くための最初の一歩である。

## 2.2 単一の責任を持つクラスをつくる

変更が簡単なアプリケーションは、再利用が簡単なクラスから構成される。

2つ以上の責任を持つクラスは、再利用が難しい。  
複数の責任が絡み合ってしまっており、ある用途に対する変更が、意図せず別の用途に影響を与える可能性がある。  
そういうクラスに変更を加えれば、予期せずアプリケーションが壊れるかもしれない。

しかし、クラスをすぐに設計し直すべきかと言えば、必ずしもそうではない。  
未来は不確かである以上、時間を掛けて設計しても、それが間違っていたという可能性は常にある。  
全ての選択には対価を伴うのであり、常にトレードオフを意識しながら決断していくしかない。

将来に対する不確実性が高い状態では、時間を掛けて設計するよりも、そのままにしておき、必要性が高まってから設計したほうがいいかもしれない。  
しかし、再利用しづらく、模範的でないコードをそのままにしておくデメリットも、確かに存在する。  
どちらかよいと、一方的に決めることは出来ない。**「いますぐ改善」と「あとで改善」の間の緊張状態は常に存在し、そのなかで折り合いをつけていくしかない。**
